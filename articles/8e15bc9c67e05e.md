---
title: "CMakeäº‹å§‹ã‚"
emoji: "ğŸ”º"
type: "tech"
topics:
  - "cpp"
  - "cmake"
  - "make"
published: true
published_at: "2023-05-09 02:05"
---

:::message alert
æœ¬ç¨¿ã¯åŸ·ç­†ä¸­ã§ã™ï¼
:::

## ã¯ã˜ã‚ã«

ãƒ“ãƒ«ãƒ‰ã¯è‡ªå‹•åŒ–ã—ãŸã„ã‚‚ã®ã§ã™ï¼
ã§ã¯CMakeã‚’ä½¿ã„ã¾ã—ã‚‡ã†ï¼

## å‰æ

### ç’°å¢ƒ

```bash
$ gcc --version
gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0

$ cmake --version
cmake version 3.22.1
```

### çŸ¥è­˜

- **ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«** ã«ã‚ˆã£ã¦ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹
- **ãƒªãƒ³ã‚¯** ã«ã‚ˆã£ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãƒ»é™çš„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹
- ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»ãƒªãƒ³ã‚¯ã«ã‚ˆã£ã¦ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚’ **ãƒ“ãƒ«ãƒ‰** ã¨è¨€ã†

### æœ¬è¨˜äº‹ã®æµã‚Œ

æœ¬è¨˜äº‹ã¯ã„ãã¤ã‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã«ã‚ˆã‚Šï¼Œæ®µéšçš„ã« CMakeLists.txt ã®ã‚³ãƒãƒ³ãƒ‰ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ã¾ã™ï¼
å„ã‚¹ãƒ†ãƒƒãƒ— (Step0 ã‚’é™¤ã) ã¯ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãŸã‚ã®

1. ã‚³ãƒãƒ³ãƒ‰
1. CMakeLists.txt

ã‚’é †ã«è§£èª¬ã—ã¦ãŠã‚Šï¼Œã‚³ãƒãƒ³ãƒ‰ã¨ CMakeLists.txt ã¨ã‚’å¯¾å¿œä»˜ã‘ã¦ç†è§£ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ï¼

> ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯å„ã‚¹ãƒ†ãƒƒãƒ—ã®å†’é ­ã«æŠ˜ã‚Šç•³ã‚“ã§ç¤ºã—ã¦ã„ã¾ã™ï¼

## Step0

ã¾ãš CMake ã‚’åˆ©ç”¨ã™ã‚‹å‹•æ©Ÿã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ï¼

> ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ã¨ãã€Œä½•æ•…ãã®ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ã®ã‹ã€ã‚’æ„è­˜ã™ã‚‹ã“ã¨ã¯é‡è¦ã§ã™ï¼

Step0 ã¯æœ¬è¨˜äº‹ã®è¶£æ—¨ã‹ã‚‰ã‚„ã‚„å¤–ã‚Œã‚‹ãŸã‚ï¼Œèª­ã¿é£›ã°ã›ã‚‹ã‚ˆã†æŠ˜ã‚Šç•³ã‚“ã§ã„ã¾ã™ï¼
èª­ã¿é£›ã°ã—ã¦é ‚ã„ã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ãŒï¼Œå¾Œã®ã‚¹ãƒ†ãƒƒãƒ—ã§ç™»å ´ã™ã‚‹ç”¨èªãƒ»æ“ä½œã®è§£èª¬ã‚’å«ã‚“ã§ã„ã‚‹ãŸã‚ï¼Œã”ä¸€èª­ãã ã•ã„ï¼

:::details CMake ã‚’åˆ©ç”¨ã™ã‚‹å‹•æ©Ÿ

`main.cpp` ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã¨ãï¼Œæ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ï¼

```bash
g++ main.cpp
```

ç°¡å˜ã§ã™ã­ï¼

ã—ã‹ã—å¤šãã®å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«ã™ã‚‹ã§ã—ã‚‡ã†ï¼

```bash
g++ -Wall -Wextra -Werror -c main.cpp
g++ -o main main.o
```

ã‚‚ã†ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ãŸããªããªã£ã¦ãã¾ã—ãŸï¼

ã§ã¯æ¬¡ã®ã‚ˆã†ãªæ§‹æˆã® `main.hpp`, `main.cpp`, `foo.cpp`, `bar.cpp` ã‹ã‚‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ« `main` ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãªã‚‰ï¼Ÿ

```tree
.
â”œâ”€â”€ main.hpp
â”œâ”€â”€ main.cpp
â”œâ”€â”€ foo.cpp
â””â”€â”€ bar.cpp
```

è€ƒãˆãŸãã‚‚ã‚ã‚Šã¾ã›ã‚“ï¼

> `g++ -o main main.cpp foo.cpp bar.cpp` ã§ã§ãã¾ã™ãŒï¼Œã“ã“ã§ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨ãƒªãƒ³ã‚¯ã¨ã‚’åˆ¥ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã«ã—ã¾ã™ï¼

ã§ã¯ã©ã†ã™ã‚Œã°è‰¯ã„ã§ã—ã‚‡ã†ã‹ï¼
ã¾ãšæ€ã„ã¤ãã®ã¯ã€Œã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ãã€ã§ã—ã‚‡ã†ï¼
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»ãƒªãƒ³ã‚¯ã«å¿…è¦ãªã‚³ãƒãƒ³ãƒ‰ã‚’çºã‚ãŸã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚Œã°ãƒ“ãƒ«ãƒ‰ã‚’åŠ¹ç‡åŒ–ã§ãã¾ã™ï¼

### ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

æ¬¡ã® `build.bash` ã¯ï¼Œå‰è¿°ã® `main.hpp`, `main.cpp`, `foo.cpp`, `bar.cpp` ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¸€ä¾‹ã§ã™ï¼

```bash:build.bash
#!/bin/bash

srcs=("main.cpp" "foo.cpp" "bar.cpp")

rm -f main *.o *.d

g++ -g -Wall -Wextra -Werror -c ${srcs[@]}
g++ -o main ${srcs[@]/%.cpp/.o}
```

ã“ã®ã‚ˆã†ãªã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦ãŠãã¨

```bash
./build.bash
```

ã®ã¿ã§ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼

ã—ã‹ã—ï¼Œã“ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã¯æ¬¡ã®ã‚ˆã†ãªå•é¡ŒãŒã‚ã‚Šã¾ã™ï¼

- bash ä»¥å¤–ã®ãƒ¦ãƒ¼ã‚¶ã‚’è€ƒæ…®ã—ã¦ã„ãªã„
	å…±åŒé–‹ç™ºè€…ãŒ bash ã¨äº’æ›æ€§ã®ãªã„ã‚·ã‚§ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ã§ã‚ã‚Œã°åˆ©ç”¨ã§ãã¾ã›ã‚“ï¼
- ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è€ƒæ…®ã—ã¦ã„ãªã„
	ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥å¤–ã‹ã‚‰å®Ÿè¡Œã§ãã‚‹ãŸã‚ï¼ŒäºˆæœŸã›ã¬å•é¡ŒãŒç™ºç”Ÿã™ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼
- ãƒªãƒ“ãƒ«ãƒ‰ã®å®Ÿè¡Œæ™‚é–“ã‚’è€ƒæ…®ã—ã¦ã„ãªã„
	ä¾‹ãˆã° `foo.cpp` ã®ã¿ã‚’å¤‰æ›´ã—ãŸå ´åˆã§ã‚‚ï¼Œå…¨ã¦ã®ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¾ã™ï¼å¤§ããªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«æ•°æ™‚é–“ã‚’è¦ã™ã‚‹ã“ã¨ãŒã‚ã‚Šï¼Œå¤‰æ›´ã®ãªã„ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã®ã¯éåŠ¹ç‡çš„ã§ã™ï¼

ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã« make ãŒã‚ã‚Šã¾ã™ï¼

### make

make ã¯åºƒãåˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã§ï¼ŒMakefile ã«è¨˜è¿°ã—ãŸãƒ“ãƒ«ãƒ‰ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼
æ¬¡ã® Makefile ã¯ï¼Œmake ã«ã‚ˆã£ã¦å‰è¿°ã® `main.hpp`, `main.cpp`, `foo.cpp`, `bar.cpp` ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãŸã‚ã® Makefile ã®ä¸€ä¾‹ã§ã™ï¼

```Makefile
CXX		:= g++
CXXFLAGS:= -g -Wall -Wextra -Werror

TARGET	:= main
SRCS	:= main.cpp foo.cpp bar.cpp
OBJS	:= $(SRCS:.cpp=.o)

INCDIR	:= 
LIBDIR	:= 
LIBS	:= 

.PHONY: all
all: clean $(TARGET)

$(TARGET): $(OBJS)
	$(CXX) -o $@ $^ $(LIBDIR) $(LIBS)

$(OBJS): $(SRCS)
	$(CXX) $(CXXFLAGS) $(INCDIR) -c $^

.PHONY: clean
clean:
	rm -f $(TARGET) *.o *.d
```

Makefile ã‚’è¨˜è¿°ã—ã¦ãŠãã¨

```bash
make
```

ã®ã¿ã§ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼

make ã«ã‚ˆã‚‹ãƒ“ãƒ«ãƒ‰ã¯ Makefile ã‚’é…ç½®ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥å¤–ã‹ã‚‰å®Ÿè¡Œã§ããšï¼Œã¾ãŸãƒªãƒ“ãƒ«ãƒ‰ã§å¤‰æ›´ã®ãªã„ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ç›´ã™ã“ã¨ã‚‚ã‚ã‚Šã¾ã›ã‚“ï¼

> make ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°ã®æœ‰ç„¡ã‚’ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‹ã‚‰ç¢ºèªã—ã¦ã„ã¾ã™ï¼

ã—ã‹ã—ï¼Œã“ã® Makefile ã«ã‚‚æ¬¡ã®ã‚ˆã†ãªå•é¡ŒãŒã‚ã‚Šã¾ã™ï¼

- ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ä¾å­˜ã™ã‚‹
	make ã¨åŒæ§˜ã« Makefile ã«å¾“ã£ã¦ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã« NMAKE ãŒã‚ã‚Šï¼ŒUnix ç’°å¢ƒã§ã¯ä¸€èˆ¬ã« make ãŒåˆ©ç”¨ã•ã‚Œã¾ã™ãŒï¼ŒWindows ç’°å¢ƒã§ã¯ NMAKE ãŒåˆ©ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼ä¸¡è€…ã® Makefile ã®æ–‡æ³•ã«ã¯äº’æ›æ€§ãŒãªãï¼Œå…±åŒé–‹ç™ºè€…ãŒäº’æ›æ€§ã®ãªã„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ¦ãƒ¼ã‚¶ã§ã‚ã‚Œã°åˆ©ç”¨ã§ãã¾ã›ã‚“ï¼
- æ–‡æ³•ãŒç‹¬ç‰¹
	è‡ªç”±åº¦ã¯é«˜ã„ã§ã™ãŒï¼Œå¯èª­æ€§ã¯é«˜ãã‚ã‚Šã¾ã›ã‚“ï¼

> NMAKE ã§ã¯  `nmake` ã§ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼

ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã®ãŒ CMake ã§ã™ï¼

### CMake

CMake ã¯ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã§ï¼ŒCMakeLists.txt ã«è¨˜è¿°ã—ãŸå†…å®¹ã«å¾“ã£ã¦ Makefile ã‚’ç”Ÿæˆã—ã¾ã™ï¼
ã“ã®ã¨ã CMake ã¯ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«å¿œã˜ãŸ Makefile ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ï¼ŒCMake ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã®ãƒ“ãƒ«ãƒ‰ãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ï¼

> CMake ã¯ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«å¿œã˜ã¦ç•°ãªã‚‹ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã€Œãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãŒåˆ©ç”¨ã™ã‚‹ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã„ã¦ Makefile ã«ç›¸å½“ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹ã€ã¨è¡¨ç¾ã™ã‚‹æ–¹ãŒé©åˆ‡ãªã®ã§ã™ãŒï¼Œç°¡å˜ã®ãŸã‚ã€ŒMakefile ã‚’ç”Ÿæˆã™ã‚‹ã€ã¨è¡¨ç¾ã—ã¦ã„ã¾ã™ï¼

æ¬¡ã® CMakeLists.txt ã¯ï¼ŒCMake ã«ã‚ˆã£ã¦å‰è¿°ã® `main.hpp`, `main.cpp`, `foo.cpp`, `bar.cpp` ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãŸã‚ã® Makefile ã‚’ç”Ÿæˆã™ã‚‹ CMakeLists.txt ã®ä¸€ä¾‹ã§ã™ï¼

```cmake:CMakeListe.txt
cmake_minimum_required(VERSION 3.22)

project(main
	VERSION 1.0
	LANGUAGES CXX
)

add_executable(${PROJECT_NAME}
	main.cpp
	foo.cpp
	bar.cpp
)
```

CMakeLists.txt ã‚’è¨˜è¿°ã—ã¦

```bash
cmake -S . -B build
```

ã‚’ä¸€åº¦å®Ÿè¡Œã—ã¦ãŠãã¨

```bash
cmake --build build
```

ã®ã¿ã§ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼

`cmake --build build` ã¯å†…éƒ¨ã§ `make`ã‚’å®Ÿè¡Œã—ï¼Œäº‹å‰ã«ç”Ÿæˆã•ã‚ŒãŸ Makefile ã«å¾“ã£ã¦å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ã—ã¾ã™ï¼

> ã“ã“ã§ã‚‚ã€Œå„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãŒåˆ©ç”¨ã™ã‚‹ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã„ã¦ `make` ã«ç›¸å½“ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€ã¨è¡¨ç¾ã™ã‚‹æ–¹ãŒé©åˆ‡ãªã®ã§ã™ãŒï¼Œã‚„ã¯ã‚Šç°¡å˜ã®ãŸã‚ã€Œ`make` ã‚’å®Ÿè¡Œã™ã‚‹ã€ã¨è¡¨ç¾ã—ã¦ã„ã¾ã™ï¼

CMakeLists.txt ã¯ Makefile ã¨åŒæ§˜ã«ç‹¬è‡ªã®æ–‡æ³•ã‚’æŒã£ã¦ã„ã¾ã™ãŒï¼ŒMakefile ã¨æ¯”è¼ƒã—ã¦å¯èª­æ€§ãŒé«˜ãï¼Œæ–°ãŸã«ç¿’å¾—ã™ã‚‹ã®ã§ã‚ã‚Œã° Makefile ã‚ˆã‚Š CMakeLists.txt ã®æ–‡æ³•ã®æ–¹ãŒå®¹æ˜“ã§ã—ã‚‡ã†ï¼

:::

## Step1

Step1 ã§ã¯æ¬¡ã®ã‚ˆã†ãªæ§‹æˆã‚’è€ƒãˆã¾ã™ï¼

```tree
.
â”œâ”€â”€ main.hpp
â”œâ”€â”€ main.cpp
â”œâ”€â”€ foo.cpp
â””â”€â”€ bar.cpp
```

:::details ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```cpp:main.hpp
#pragma once

auto foo() -> void;
auto bar() -> void;
```

```cpp:main.cpp
#include "main.hpp"

auto main() -> int {
	foo();
	bar();
}
```

```cpp:foo.cpp
#include "main.hpp"

#include <iostream>

auto foo() -> void {
	std::cout << "foo" << std::endl;
}
```

```cpp:bar.cpp
#include "main.hpp"

#include <iostream>

auto bar() -> void {
	std::cout << "bar" << std::endl;
}
```

:::

- **command ver.**

	æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼

	```bash
	# main.cpp (ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«) ã‹ã‚‰ main.o (ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«) ã‚’ç”Ÿæˆ
	g++ -c main.cpp foo.cpp bar.cpp
	# main.o (ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«) ã‹ã‚‰ main (å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«) ã‚’ç”Ÿæˆ
	g++ -o main main.o foo.cpp bar.cpp
	```

	ã“ã‚Œã§å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ« `main` ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼

- **CMake ver.**
	æ¬¡ã®ä½ç½®ã« CMake Lists.txt ã‚’ä½œæˆã—ã¾ã™ï¼

	```tree
	.
	â”œâ”€â”€ main.hpp
	â”œâ”€â”€ main.cpp
	â”œâ”€â”€ foo.cpp
	â”œâ”€â”€ bar.cpp
	â””â”€â”€ CMakeLists.txt
	```

	CMakeLists.txt ã‚’æ¬¡ã®ã‚ˆã†ã«è¨˜è¿°ã—ã¾ã™ï¼

	```cmake:CMakeListe.txt
	# å„è¡Œã®ã‚·ãƒ£ãƒ¼ãƒ—è¨˜å·ã‚ˆã‚Šå¾Œã¯ã‚³ãƒ¡ãƒ³ãƒˆã¨èªè­˜ã•ã‚Œã¾ã™
	cmake_minimum_required(VERSION 3.22)

	project(main
		VERSION 1.0
		LANGUAGES CXX
	)

	add_executable(main
		main.cpp
		foo.cpp
		bar.cpp
	)
	```

	ã“ã®å¾Œã« `.` ã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼

	```bash
	cmake -S . -B build
	cmake --build build
	```

	ã“ã‚Œã§ `./build` ã«å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ« `main` ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼

	å¾Œè¿°ã—ã¾ã™ãŒï¼Œ`cmake -S . -B build` ã‚’æ¯å›å®Ÿè¡Œã™ã‚‹å¿…è¦ã¯ãªã

	```bash
	cmake -S . -B build
	```

	ã®ã¿ã§ãƒªãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼

	ä»¥é™ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯CMakeLists.txt ã®ã¿ã‚’æ²è¼‰ã—ã¾ã™ãŒï¼Œãƒ“ãƒ«ãƒ‰æ‰‹é †ã¯åŒã˜ã§ã™ï¼

### in-source ãƒ“ãƒ«ãƒ‰ãƒ»out-of-source ãƒ“ãƒ«ãƒ‰

```bash
cmake -S . -B build
```

ã¯ã‚½ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ `.` ã«ï¼Œãƒ“ãƒ«ãƒ‰ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ `build` ã«ãã‚Œãã‚Œè¨­å®šã—ï¼ŒCMakeLists.txt ã«è¨˜è¿°ã—ãŸå†…å®¹ã«å¾“ã£ã¦Makefile ç­‰ã®ãƒ“ãƒ«ãƒ‰ã«å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `build` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å‡ºåŠ›ã—ã¾ã™ï¼`build` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã‘ã‚Œã°åŒæ™‚ã«ä½œæˆã—ã¾ã™ï¼
ã“ã®ã‚ˆã†ã«ãƒ“ãƒ«ãƒ‰ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒã‚½ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ç•°ãªã‚‹ãƒ“ãƒ«ãƒ‰ã‚’ **out-of-source ãƒ“ãƒ«ãƒ‰** ã¨è¨€ã„ã¾ã™ï¼

> ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚½ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼Œ`cmake` ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ Makefile ç­‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ“ãƒ«ãƒ‰ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºåŠ›ã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒ“ãƒ«ãƒ‰ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨è¨€ã„ã¾ã™ï¼

ä»£ãˆã¦

```bash
cmake .
```

ã¯ã‚½ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ»ãƒ“ãƒ«ãƒ‰ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å…±ã« `.` ã«è¨­å®šã—ã¾ã™ï¼
ã“ã®ã‚ˆã†ã«ãƒ“ãƒ«ãƒ‰ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒã‚½ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨åŒã˜ã§ã‚ã‚‹ãƒ“ãƒ«ãƒ‰ã‚’ **in-souce ãƒ“ãƒ«ãƒ‰** ã¨è¨€ã„ã¾ã™ï¼

in-source ãƒ“ãƒ«ãƒ‰ã¨ out-of-source ãƒ“ãƒ«ãƒ‰ã¨ã§ã¯ **out-of-source ãƒ“ãƒ«ãƒ‰ã‚’ã™ã¹ã** ã§ã™ï¼
in-source ãƒ“ãƒ«ãƒ‰ã§ã¯ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã¨ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ãŒå˜ä¸€ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ··åœ¨ã™ã‚‹ãŸã‚ï¼Œãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ãŒå›°é›£ã§ã™ï¼
å¯¾ã—ã¦ out-of-source ãƒ“ãƒ«ãƒ‰ã¯ `rm -r build` ã®ã¿ã§å…¨ã¦ã®ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã§ãã‚‹ãŸã‚ï¼Œã‚¯ãƒªãƒ¼ãƒ³ãƒ“ãƒ«ãƒ‰ãŒå®¹æ˜“ã§ã™ï¼

ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã¯ `build` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã¦ã„ãªã„å ´åˆã‚„ CMakeLists.txt ã‚’æ›´æ–°ã—ãŸå ´åˆã«å®Ÿè¡Œã—ã¾ã™ï¼

---

ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ç™»å ´ã—ãŸã‚³ãƒãƒ³ãƒ‰ã¯æ¬¡ã®3ã¤ã§ã™ï¼

### `cmake_minimum_required()`

æ¬¡ã®ã‚ˆã†ã«æœ€ä½è¦ä»¶ã‚’è¨­å®šã—ã¾ã™ï¼

```cmake
cmake_minimum_required(
	VERSION 3.22 # ãƒãƒ¼ã‚¸ãƒ§ãƒ³
)
```

ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯å¿…é ˆã®é …ç›®ã§ï¼Œè¨­å®šã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚ˆã‚Šå¤ã„ CMake ã‚’åˆ©ç”¨ã—ãŸå ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ã¾ã™ï¼

`cmake_minimum_required()` ã¯ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®CMakeLists.txt ã®å…ˆé ­ã«è¨˜è¿°ã—ã¾ã™ï¼

> ã€Œãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®ã€ã¯ã€Œã‚½ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã€ã¨åŒç¾©ã§ã™ï¼
> æ•¢ãˆã¦ã“ã®ã‚ˆã†ãªè¡¨ç¾ã‚’ã™ã‚‹ã®ã¯ï¼Œã‚½ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚ˆã‚Šä¸‹ã®éšå±¤ã«åˆ¥ã® CMakeLists.txt ã‚’ä½œæˆã™ã‚‹å ´åˆãŒã‚ã‚‹ãŸã‚ã§ã™ï¼

### `project()`

æ¬¡ã®ã‚ˆã†ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æƒ…å ±ã‚’è¨­å®šã—ã¾ã™ï¼

```cmake
project(cmake_tutorial # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
	VERSION 1.0 # ãƒãƒ¼ã‚¸ãƒ§ãƒ³
	DESCRIPTION "This project is a tutorial on CMake" # èª¬æ˜æ–‡
	HOMEPAGE_URL "example.com" # ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸URL
	LANGUAGES C CXX # ä½¿ç”¨è¨€èª
)
```

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¯å¿…é ˆã®é …ç›®ã§ã™ï¼ã¾ãŸå¤šãã®å ´åˆï¼Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ»ä½¿ç”¨è¨€èªã®é …ç›®ã‚’è¨­å®šã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ï¼

ä½¿ç”¨è¨€èªã¯

- C ãªã‚‰ `C`
- C++ ãªã‚‰ `CXX`

ã®ã‚ˆã†ã«è¨­å®šã—ã¾ã™ï¼

> `C` `CXX` ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®šã•ã‚Œã¦ã„ã¾ã™ï¼

`project()` ã¯ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã® CMakeLists.txt ã® `cmake_minimum_required()` ã«ç¶šã‘ã¦è¨˜è¿°ã—ã¾ã™ï¼

### `add_executable()`

executable ã¯å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã®æ„ã§ï¼Œæ¬¡ã®ã‚ˆã†ã«ç”Ÿæˆã™ã‚‹å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ã®æƒ…å ±ã‚’ãƒ“ãƒ«ãƒ‰ãƒ«ãƒ¼ãƒ«ã«è¿½åŠ ã—ã¾ã™ï¼

```cmake
add_executable(main # å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«
	main.cpp # ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«1
	foo.cpp # ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«2
	bar.cpp # ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«3
)
```

ã“ã‚Œã¯

- å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ« `main` ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨
- ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒ `main.cpp`, `foo.cpp`, `bar.cpp` ã§ã‚ã‚‹ã“ã¨

ã‚’è¨­å®šã—ã¦ãŠã‚Šï¼Œã‚³ãƒãƒ³ãƒ‰ã®

```bash
g++ -c main.cpp foo.cpp bar.cpp
g++ -o main main.o foo.cpp bar.cpp
```

ã®éƒ¨åˆ†ã«ç›¸å½“ã—ã¾ã™ï¼

### å¤‰æ•°

å¤‰æ•°ã«ã¤ã„ã¦ç°¡å˜ã«è§£èª¬ã—ã¾ã™ï¼
CMakeLists.txt ã«ç™»å ´ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã®å¤šãã¯å†…éƒ¨ã§å¤‰æ•°ã®å€¤ã‚’è¨­å®šã—ã¦ãŠã‚Šï¼Œä¾‹ãˆã°

- `cmake_minimum_required(VERSION 3.22)` ã¯
    - `CMAKE_MINIMUM_REQUIRED_VERSION` ã¨ã„ã†å¤‰æ•°ã®å€¤ã‚’ `3.22` ã«
- `project(cmake_tutorial VERSION 1.0)` ã¯
    - `PROJECT_NAME` ã¨ã„ã†å¤‰æ•°ã®å€¤ã‚’ `cmake_tutorial` ã«
    - `PROJECT_VERSION` ãŠã‚ˆã³ `cmake_tutorial_VERSION` ã¨ã„ã†å¤‰æ•°ã®å€¤ã‚’ `1.0` ã«

ãã‚Œãã‚Œè¨­å®šã—ã¦ã„ã¾ã™ï¼

å„å¤‰æ•°ã®å€¤ã¯æ¬¡ã®ã‚ˆã†ã« `${å¤‰æ•°å}` ã§å–ã‚Šå‡ºã™ã“ã¨ãŒã§ãã¾ã™ï¼

```cmake
message("${CMAKE_MINIMUM_REQUIRED_VERSION}")
message("${PROJECT_NAME}")
message("${PROJECT_VERSIOIN}")
message("${${PROJECT_NAME}_VERSIOIN}")
```

> `message()` ã¯ CMake ã«ãŠã‘ã‚‹ ãƒ­ã‚°å‡ºåŠ›ã®ã‚ˆã†ãªã‚‚ã®ã§ï¼Œ`message("Hello, world!")` ã¨ã™ã‚‹ã¨å®Ÿè¡Œãƒ­ã‚°ã« `Hello, world!` ã‚’å‡ºåŠ›ã—ã¾ã™

ã“ã‚Œã«ã‚ˆã‚Šï¼Œç”Ÿæˆã™ã‚‹å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«åãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¨åŒã˜ã§ã‚ã‚‹å ´åˆï¼Œå‰è¿°ã® `add_executable()` ã‚’æ¬¡ã®ã‚ˆã†ã«è¨˜è¿°ã§ãã¾ã™ï¼

```cmake
add_executable(${PROJECT_NAME}
	main.cpp
	foo.cpp
	bar.cpp
)
```

---

ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è§£èª¬ã—ãŸã‚³ãƒãƒ³ãƒ‰ã®è©³ç´°ã¯æ¬¡ã®ãƒªãƒ³ã‚¯ã‹ã‚‰ç¢ºèªã§ãã¾ã™ï¼

- [cmake_minimum_required](https://cmake.org/cmake/help/latest/command/cmake_minimum_required.html)
- [project](https://cmake.org/cmake/help/latest/command/project.html)
- [add_executable](https://cmake.org/cmake/help/latest/command/add_executable.html)
- [message](https://cmake.org/cmake/help/latest/command/message.html)

> ãƒªãƒ³ã‚¯å…ˆã®å†…å®¹ã¯ãã‚Œãã‚Œæœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® CMake ã«æº–æ‹ ã—ã¦ã„ã‚‹ãŸã‚ï¼Œæ³¨æ„ã—ã¦ãã ã•ã„ï¼

## Step2

:::message alert
ä»¥é™ã¯åŸ·ç­†ä¸­ã§ã™ï¼
:::
